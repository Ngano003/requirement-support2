# 検出すべき「ヌケ・モレ・矛盾」分類表 (Defect Taxonomy)

人間（設計者）が見落としやすく、かつシステム品質への影響が大きい「ヌケ・モレ・矛盾」をリストアップしました。
これらを「Graph（構造的問題）」と「LLM（意味的問題）」のどちらで解くべきか定義することで、実装の方針を明確にします。

## 優先度高：人間が見落としがちで効果が高いもの

| No | 欠陥の種類 | 具体例 | なぜ見落とすのか？ | 検出アプローチ |
| :--- | :--- | :--- | :--- | :--- |
| 1 | **状態の袋小路 (Dead Ends)** | エラー画面が出た後、どのボタンを押してもホームに戻れない。 | 異常系の設計は後回しにされやすく、「戻る」パスを書き忘れる。 | **Graph**<br>出次数=0のノード検出 |
| 2 | **条件の網羅漏れ (Missing Else)** | 「温度 > 50℃ならファンを回す」とあるが、「50℃以下」の場合に止めるのかそのままかが不明。 | 正常系（Happy Path）に意識が集中し、条件の境界値や逆パターンを忘れる。 | **LLM**<br>抽出された遷移条件に対し「Elseはあるか？」を問う。 |
| 3 | **孤立した機能 (Orphan States)** | 仕様書には「デバッグモード」の記述があるが、そこに入る手順が存在しない。 | 仕様変更で入り口が削除された際、本体の記述だけ残ってしまう。 | **Graph**<br>入次数=0のノード検出 |
| 4 | **矛盾する命令 (Conflicting Outputs)** | 「解錠時は緑LED点灯」と「エラー時は赤LED点灯」が同時に発生するシナリオがある。 | 機能ごとにページが分かれているため、組み合わせ発生時の競合に気付けない。 | **Graph + Rule**<br>パス探索で複数のOutputが重なる箇所を特定。 |
| 5 | **未定義の副作用 (Unstated Side Effects)** | モーターを回し始めた後、いつ止まるのか書かれていない（垂れ流し）。 | 「開始」することに満足し、「終了」や「後始末」の定義を忘れる。 | **Graph**<br>状態遷移ペアの整合性チェック（OnがあるのにOffがないパス）。 |

## 優先度中：高度だが検出価値があるもの

| No | 欠陥の種類 | 具体例 | なぜ見落とすのか？ | 検出アプローチ |
| :--- | :--- | :--- | :--- | :--- |
| 6 | **タイミング矛盾 (Timing Violation)** | 「応答0.1秒以内」の処理フローの中に、通信タイムアウト10秒の処理が含まれている。 | 個別の処理時間は把握していても、積算時間と制約の比較計算は頭では難しい。 | **Graph**<br>パス上のコスト積算 vs 制約値。 |
| 7 | **循環依存・デッドロック (Cycles)** | Aの完了にはBが必要で、Bの完了にはAが必要。 | 複数のシステムやアクターが絡むと、依存関係のループが見えなくなる。 | **Graph**<br>閉路検出アルゴリズム。 |
| 8 | **専門用語の揺らぎ (Ambiguous Terms)** | ある箇所では「ユーザー」、別の箇所では「管理者」と書かれているが、実は同一人物を指している。 | 複数人で分担執筆する場合に用語統一が漏れる。 | **LLM**<br>Entity名寄せ、類似語検出。 |

## 戦略的提案：まずはここから

以下の3つを「優先度高」とした根拠は、**「発生頻度 (Frequency)」「影響度 (Impact)」「検出確度 (Detectability)」** の3軸評価に基づいています。

| 項目 | 発生頻度 | 影響度 | 検出確度 | 選定理由 |
| :--- | :--- | :--- | :--- | :--- |
| **1. Dead Ends**<br>(行き止まり) | **中**<br>異常系で多発 | **大**<br>再起動が必要になる<br>ユーザー体験毀損 | **高** (Graph)<br>構造的に白黒つくため誤検知が少ない | 「見逃すと致命的だが、機械なら100%見つけられる」ため、費用対効果が最強。 |
| **2. Missing Else**<br>(条件漏れ) | **高**<br>人間はHappy Pathしか考えない傾向がある | **中〜大**<br>不定動作によるバグ<br>セキュリティホール | **中** (LLM)<br>文脈理解が必要だが最近のLLMなら実用レベル | 最も頻繁に発生し、エンジニアの手戻り原因No.1であるため、これを潰すと生産性が向上する。 |
| **3. Conflicting Outputs**<br>(競合) | **低〜中**<br>複雑な仕様で発生 | **特大**<br>ハードウェア破損<br>発火・故障 | **高** (Graph)<br>論理的なパス探索で検出可能 | 発生頻度は低いが、起きた場合の物理的損害（機器故障）が許容できないため。 |

---
このリストに基づき、まずは **「Dead Ends（実装済み）」** に加え、**「Missing Else（LLM）」** と **「Conflicting Outputs（Graph探索）」** の2機能を追加実装するのが良いと考えます。
